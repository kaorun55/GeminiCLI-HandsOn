# ToDoリスト開発ハンズオン (6/6) - リアルタイム更新の実装

GUIを操作している間に、外部（例えば、私のようなMCPエージェントや、別のターミナルで実行したCLIコマンド）からタスクが変更された場合、その結果をGUIに即座に反映させる「リアルタイム更新」機能を実装します。

## ステップ7：MCPからの操作をGUIに反映させる

### 1. 背景：なぜリアルタイム更新が必要か？
GUIアプリとCLIコマンドは、それぞれ独立したプロセスとして実行されます。そのため、CLIが `tasks.json` を変更しても、起動中のGUIアプリはそれを検知できません。この問題を解決するために、ファイルの変更を監視する仕組みを導入します。

### 2. ファイル監視ライブラリのインストール
Pythonでファイルシステムの変更を監視するための定番ライブラリ `watchdog` をインストールします。

**【やってみよう】**
以下のコマンドを実行してください。
```
pip install watchdog
```

### 3. GUIコードの改良
`watchdog` を使って `tasks.json` への変更を監視し、変更があった場合にリストの表示を自動で更新するように `_demo/src/todo_gui.py` を改良します。

**【やってみよう】**
Geminiに以下の指示を出してください。

```
`_demo/src/todo_gui.py` を読み込んで、`watchdog` ライブラリを使ってリアルタイム更新機能を追加してください。

- `tasks.json` ファイルが変更されたことを検知できるようにする。
- 変更が検知されたら、GUIのタスク一覧を自動的に再描画する。
- ファイル監視は、GUIの動作を妨げないようにバックグラウンドで実行する。
```

### 4. リアルタイム更新の体験
改良したコードを保存したら、いよいよMCPとの連携を試します。

**【やってみよう】**
1.  まず、改良版のGUIアプリを起動します。**ウィンドウは開いたままにしてください。**
    ```
    python _demo/src/todo_gui.py
    ```
2.  次に、**GUIアプリを開いたままの状態で**、私（Gemini）にCLI版のコマンドを実行させてください。以下の指示を私に送ってください。
    ```
    CLIツールを使って、`_demo/src/todo.py` の `add` コマンドで「MCPからのリアルタイムテスト」というタスクを追加してください。
    ```
3.  CLIコマンドが実行されると、GUIアプリのリストに新しいタスクが**自動で**追加されることを確認してください。

---

これで、本ハンズオンのすべてのステップは完了です。お疲れ様でした！
あなたは、Gemini CLIを使ってツールの作成、ファイル操作、コマンド実行、そしてGUI化とリアルタイム連携まで、一通りの開発プロセスを体験しました。
