# ToDoリスト開発ハンズオン (7/7) - 【発展】MCPとツールの仕組み

これまでのハンズオンで、私（Gemini）は `write_file` や `run_shell_command` といったツールを自律的に使ってきました。では、なぜ私は自分がこれらのツールを使えることを知っているのでしょうか？

この章では、その舞台裏である「ツールの定義」について解説します。これはMCP（Model-as-a-Controller）の根幹をなす非常に重要な概念です。

## 1. AIへの「道具箱」の渡し方

セッションの開始時、私のようなAIモデルは、開発者から**「ツール定義」**と呼ばれるJSON形式のリストを受け取ります。これは、AIにとっての「使える道具の一覧と、その取扱説明書」です。

ユーザーが「〇〇して」と指示したとき、AIは自身の持つツール定義リストの中から、その指示を最もよく実行できそうなツールを探し出し、使い方（引数）を決定して実行します。

## 2. ツール定義JSONの構造

実際に、このハンズオンで多用した `run_shell_command` のツール定義がどのようなものか見てみましょう。これは、AIに渡されている設定情報そのものです。

```json
{
  "name": "run_shell_command",
  "description": "このツールは、指定されたシェルコマンドを `bash -c <command>` として実行します。バックグラウンドプロセスを開始するために `&` を使用できます。",
  "parameters": {
    "type": "object",
    "properties": {
      "command": {
        "type": "string",
        "description": "`bash -c <command>` として実行する正確なbashコマンド。"
      },
      "description": {
        "type": "string",
        "description": "ユーザーのためのコマンドの簡単な説明。具体的かつ簡潔に、理想的には1文で。"
      },
      "directory": {
        "type": "string",
        "description": "(任意) コマンドを実行するディレクトリ。プロジェクトのルートディレクトリでない場合。"
      }
    },
    "required": [
      "command"
    ]
  }
}
```

### 主なキーの説明

-   `name`: **ツールの名前**。AIがツールを呼び出すときに使う一意の識別子です。
-   `description`: **ツールの説明**。**これが最も重要です。** AIは、ユーザーの指示の意図を解釈し、この `description` を読んでどのツールが最適かを判断します。
-   `parameters`: **ツールが受け取る引数**の定義。
    -   `properties`: 各引数の詳細な定義。
        -   `command` (引数名): 引数の名前。
        -   `type`: 引数のデータ型（`string`, `number`, `boolean`など）。
        -   `description`: **この引数が何のためのものか**を説明します。AIはこれを読んで、ユーザーの指示からどの部分をこの引数に渡すべきかを判断します。
    -   `required`: 必須の引数をリストで指定します。

## 3. 舞台裏の動き

あなたが「`src` ディレクトリを作成して」と指示したときの、���の頭の中の動きは以下のようになります。

1.  **指示の解釈:** 「ディレクトリを作成」というキーワードを認識する。
2.  **ツール検索:** 自分のツール定義リストを調べる。「ディレクトリ作成」に最も関連性が高いのはどのツールか？
3.  **ツール選択:** `run_shell_command` の `description` に「シェルコマンドを実行する」と書かれているため、これを使えば `mkdir` コマンドで実現できると判断する。
4.  **引数の決定:**
    -   `run_shell_command` の `command` 引数が必要だとわかる。
    -   `command` 引数の `description` を読み、「実行するコマンド」を渡せばよいと理解する。
    -   ユーザーの指示から、実行すべきコマンドは `mkdir src` だと結論付ける。
5.  **ツール呼び出しの生成:** 上記の判断に基づき、最終的なツール呼び出し（Function Call）のコードを生成して実行する。

このように、JSONで定義された「ツールの取扱説明書」が、自然言語の指示と具体的なアクションを結びつけるための��要な橋渡し役となっているのです。
